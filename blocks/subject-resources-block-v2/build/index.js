!function(){"use strict";var e,t={908:function(){var e=window.wp.blocks,t=window.wp.i18n,s=window.wp.element,r=window.wp.blockEditor,l=window.wp.components;window.wp.apiFetch,(0,e.registerBlockType)("oer-block/subject-resources-block",{title:(0,t.__)("WP OER Subject Resources Block v2","oer-subject-resources-block"),description:(0,t.__)("Displays list of resources according to subject areas.","oer-subject-resources-block"),category:"widgets",icon:{foreground:"#121212",src:"welcome-widgets-menus"},keywords:[(0,t.__)("OER"),(0,t.__)("Resource"),(0,t.__)("Subject Areas")],attributes:{content:{type:"string",selector:"p"},title:{type:"string",selector:"h2"},link:{type:"string",selector:"a"},displayCount:{type:"string",selector:"display-count",default:5},selectedSubject:{type:"number",default:0},sort:{type:"string",selector:"sort-option",default:"modified"},selectedSubjectResources:{type:"array"},subjects:{type:"array"},selectedSubjects:{type:"string"},childSubjects:{type:"array"},isChanged:{type:"boolean",default:!1},blockId:{type:"string"},firstLoad:{type:"boolean",default:!0}},edit:function(e){var a,o=[],c=[];let n,i;var u;String.prototype.ucwords=function(){return this.toLowerCase().replace(/(^([a-zA-Z\p{M}]))|([ -][a-zA-Z\p{M}])/g,(function(e){return e.toUpperCase()}))};const{attributes:d,setAttributes:m,clientId:p}=e;p!==d.blockId&&m({blockId:p}),d.firstLoad&&(wp.apiFetch({url:oer_subject_resources.home_url+"/wp-json/oer/v2/subjects"}).then((e=>{m({subjects:e})})),(e=>{d.selectedSubjects;var t=d.displayCount,s=d.sort;"object"==typeof wp.api.collections&&(e=>{try{new e}catch(e){return!1}return!0})(wp.api.collections.Resource)&&(new wp.api.collections.Resource).fetch({data:{per_page:t,orderby:s,order:"asc"}}).then((e=>{m({selectedSubjectResources:e})}))})(),m({firstLoad:!1}));let b=[{value:"5",label:(0,t.__)("5")},{value:"10",label:(0,t.__)("10")},{value:"15",label:(0,t.__)("15")},{value:"20",label:(0,t.__)("20")},{value:"25",label:(0,t.__)("25")},{value:"30",label:(0,t.__)("30")}],_=[{value:"modified",label:(0,t.__)("Date Updated")},{value:"date",label:(0,t.__)("Date Added")},{value:"title",label:(0,t.__)("Title a-z")}];void 0===d.subjects?o=(0,t.__)("Loading..."):c=d.subjects.sort(((e,t)=>e.label<t.label?-1:e.label>t.label?1:0));const v=c.map(((e,t)=>(0,s.createElement)(l.CheckboxControl,{value:e.term_id,label:e.name,key:t,name:"selectedSubjects[]",className:"child"==e.type?"oer-subject-area-child":"oer-subject-area-parent",checked:a,id:e.term_id,onChange:function(t){let s=d.selectedSubjects?d.selectedSubjects:[];t?(void 0!==s?-1===s.indexOf(e.term_id)&&s.push(e.term_id):s.push(e.term_id),a=!0):(s=d.selectedSubjects.filter((t=>t!==e.term_id)),a=!1),jQuery("#"+e.term_id).prop("checked",a),m({selectedSubjects:s}),console.log(d.selectedSubjects)}})));if(void 0!==d.selectedSubjectResources&&d.selectedSubjectResources.length>0){n=_.map(((e,t)=>(0,s.createElement)("li",{key:e.value,value:e.value},e.label))),void 0!==d&&(u=d.sort.ucwords());const e="Browse "+d.selectedSubjectResources.length.toString()+" resources";i=(0,s.createElement)("div",{className:"oer-snglrsrchdng"},e,(0,s.createElement)("div",{className:"sort-box"},(0,s.createElement)("span",{className:"sortoption"},u),(0,s.createElement)("span",{className:"sort-resources",title:"Sort resources",tabindex:"0",role:"button"},(0,s.createElement)("i",{className:"fa fa-sort","aria-hidden":"true"})),(0,s.createElement)("div",{className:"sort-options"},(0,s.createElement)("ul",{className:"sortList"},n)),(0,s.createElement)(l.SelectControl,{className:"sort-selectbox",value:d.sort,options:_}))),d.selectedSubjectResources.map(((e,t)=>{let r=[];null!==e.subject_details&&e.subject_details.map(((e,t)=>{r.push((0,s.createElement)("span",{key:t},(0,s.createElement)("a",{href:e.link},e.name)))})),o.push((0,s.createElement)("div",{key:t,className:"post oer-snglrsrc"},(0,s.createElement)("a",{href:e.link,className:"oer-resource-link"},(0,s.createElement)("div",{className:"oer-snglimglft"},(0,s.createElement)("img",{src:e.fimg_url}))),(0,s.createElement)("div",{className:"oer-snglttldscrght"},(0,s.createElement)("div",{className:"ttl"},(0,s.createElement)("a",{href:e.link},e.title.rendered)),(0,s.createElement)("div",{className:"post-meta"},(0,s.createElement)("span",{className:"post-meta-box post-meta-grades"},(0,s.createElement)("strong",null,"Grades: "),e.oer_grade),(0,s.createElement)("span",{className:"post-meta-box post-meta-domain"},(0,s.createElement)("strong",null,"Domain: "),(0,s.createElement)("a",{href:e.link},e.domain))),(0,s.createElement)("div",{className:"desc"},(0,s.createElement)("div",{dangerouslySetInnerHTML:{__html:e.resource_excerpt}})),(0,s.createElement)("div",{className:"tagcloud"},r))))}))}return[(0,s.createElement)(s.Fragment,null,(0,s.createElement)(r.InspectorControls,{className:"oer-subject-resources-block-inspector"},(0,s.createElement)(l.PanelBody,{title:"OER Subject Resources Option",initialOpen:!0},(0,s.createElement)(l.PanelRow,null,(0,s.createElement)("div",{className:"form-group oer-inspector-subjects"},(0,s.createElement)("label",null,"Subject(s);"),(0,s.createElement)("div",{className:"editor-post-taxonomies__hierarchical-terms-list"},v))),(0,s.createElement)(l.PanelRow,null,(0,s.createElement)(l.SelectControl,{className:"display-count",label:(0,t.__)("# of Resources to display:"),value:d.displayCount,options:b,onChange:e=>{this.setAttributes({displayCount:e,isChanged:!0}),this.selectResources(!0)}})),(0,s.createElement)(l.PanelRow,null,(0,s.createElement)(l.SelectControl,{className:"sort-option",label:(0,t.__)("Sort:"),value:d.sort,options:_,onChange:e=>{this.setAttributes({sort:e,isChanged:!0}),this.selectResources(!0)}}))))),(0,s.createElement)("div",{className:"oer-subject-resources-list"},o)]}})}},s={};function r(e){var l=s[e];if(void 0!==l)return l.exports;var a=s[e]={exports:{}};return t[e](a,a.exports,r),a.exports}r.m=t,e=[],r.O=function(t,s,l,a){if(!s){var o=1/0;for(u=0;u<e.length;u++){s=e[u][0],l=e[u][1],a=e[u][2];for(var c=!0,n=0;n<s.length;n++)(!1&a||o>=a)&&Object.keys(r.O).every((function(e){return r.O[e](s[n])}))?s.splice(n--,1):(c=!1,a<o&&(o=a));if(c){e.splice(u--,1);var i=l();void 0!==i&&(t=i)}}return t}a=a||0;for(var u=e.length;u>0&&e[u-1][2]>a;u--)e[u]=e[u-1];e[u]=[s,l,a]},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e={826:0,46:0};r.O.j=function(t){return 0===e[t]};var t=function(t,s){var l,a,o=s[0],c=s[1],n=s[2],i=0;if(o.some((function(t){return 0!==e[t]}))){for(l in c)r.o(c,l)&&(r.m[l]=c[l]);if(n)var u=n(r)}for(t&&t(s);i<o.length;i++)a=o[i],r.o(e,a)&&e[a]&&e[a][0](),e[o[i]]=0;return r.O(u)},s=self.webpackChunkoer_subject_resources_block=self.webpackChunkoer_subject_resources_block||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))}();var l=r.O(void 0,[46],(function(){return r(908)}));l=r.O(l)}();